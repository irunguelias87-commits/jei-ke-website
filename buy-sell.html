<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Buy & Sell - Light Rays Market</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<header>
  <h1>Light Rays Market</h1>
  <nav>
    <a href="index.html">Home</a>
    <a href="buy-sell.html" class="active">Buy & Sell</a>
    <a href="services.html">Services</a>
    <a href="bills.html">Pay Bills</a>
    <a href="contact.html">Contact</a>
  </nav>
</header>

<main>
  <h2>Buy & Sell Products</h2>

<div id="filters">
  <button onclick="filterProducts('all')">All</button>
  <button onclick="filterProducts('electronics')">Electronics</button>
  <button onclick="filterProducts('fashion')">Fashion</button>
  <button onclick="filterProducts('services')">Services</button>
</div>
  <div class="featured-grid" id="product-list"></div><h2>Admin: Add New Product</h2>
<div id="admin-form">
  <input type="text" id="newName" placeholder="Product Name">
  <input type="number" id="newPrice" placeholder="Price">
  <input type="text" id="newImg" placeholder="Image URL">
  <button id="addProductBtn" class="btn">Add Product</button>
</div>


  <h2>Your Cart</h2>
  <div id="cart">
    <p>No items in cart.</p>
  </div>

  <button id="checkoutBtn" class="btn">Generate Receipt & Pay via Mpesa</button>

  <h2>Seller Locations</h2>
  <div id="map" style="width:100%;height:300px;"></div>
</main>

<footer>
<p>Â© 2025 Light Rays Media | WhatsApp: <a href="https://wa.me/254768814953">0768814953</a> | Facebook: <a href="https://www.facebook.com/JeiKe">Jei Ke</a></p>
</footer>

<script>
  // Product listfunction filterProducts(category){
  const filtered = category==='all' ? products : products.filter(p=>p.category===category);
  renderProducts(filtered);
}

  const products = [
    {name: 'Samsung Galaxy A32', price: 18000, img:'https://via.placeholder.com/400x300.png?text=Smartphone'},
    {name: 'Laptop Core i5', price: 45000, img:'https://via.placeholder.com/400x300.png?text=Laptop'},
    {name: 'Sport Shoes', price: 3500, img:'https://via.placeholder.com/400x300.png?text=Shoes'},
    {name: 'Graphic Design Service', price: 2000, img:'https://via.placeholder.com/400x300.png?text=Graphic+Design'}
  ];

  const productList = document.getElementById('product-list');
  const cartDiv = document.getElementById('cart');
  let cart = [];

  function renderProducts(){document.getElementById('addProductBtn').addEventListener('click', ()=>{
  const name = document.getElementById('newName').value;
  const price = parseFloat(document.getElementById('newPrice').value);
  const img = document.getElementById('newImg').value;

  if(!name || !price || !img){
    alert("Please fill all fields.");
    return;
  }

  products.push({name, price, img});
  renderProducts();
function renderProducts(list = products){
  productList.innerHTML = '';
  list.forEach((p,index)=>{
    // same card code as before
  });
}

  // clear form
  document.getElementById('newName').value = '';
  document.getElementById('newPrice').value = '';
  document.getElementById('newImg').value = '';

  alert("Product added successfully!");
});

    productList.innerHTML = '';
    products.forEach((p, index)=>{
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <img src="${p.img}" alt="${p.name}">
        <div class="title">${p.name}</div>
        <div class="price">Ksh ${p.price}</div>
        <button class="btn" onclick="addToCart(${index})">Add to Cart</button>
        <a class="btn" href="https://wa.me/254768814953?text=Hi%20Jei%20Ke,%20I%20am%20interested%20in%20${encodeURIComponent(p.name)}">Contact Seller</a>
      `;
      productList.appendChild(card);
    });
  }

  function addToCart(index){
    cart.push(products[index]);
    renderCart();
  }

  function renderCart(){
    if(cart.length===0){
      cartDiv.innerHTML = '<p>No items in cart.</p>';
      return;
    }
    let html = '<ul>';
    let total = 0;
    cart.forEach((item,i)=>{
      html += `<li>${item.name} - Ksh ${item.price} <button onclick="removeFromCart(${i})">Remove</button></li>`;
      total += item.price;
    });
    html += `</ul><p><strong>Total: Ksh ${total}</strong></p>`;
    cartDiv.innerHTML = html;
  }

  function removeFromCart(index){
    cart.splice(index,1);
    renderCart();
  }

  document.getElementById('checkoutBtn').addEventListener('click', ()=>{
    if(cart.length===0){
      alert('Cart is empty!');
      return;
    }
    let total = cart.reduce((sum,item)=>sum+item.price,0);
    let receipt = 'Receipt:\n\n';
    cart.forEach(item=>{receipt+=`${item.name} - Ksh ${item.price}\n`;});
    receipt += `\nTotal: Ksh ${total}\n\nProceed to pay via Mpesa.`;

    if(confirm(receipt + "\n\nClick OK to simulate Mpesa payment")) {
      alert("Mpesa payment request sent to 0768814953. Thank you for your purchase!");
      cart = [];
      renderCart();
    }
  });

  renderProducts();
  renderCart();

  // Google Maps
  function initMap() {
    const locations = [
      {lat: -1.286389, lng: 36.817223, name: "Jei Ke Shop 1"},
      {lat: -1.292066, lng: 36.821945, name: "Jei Ke Shop 2"}
    ];<a href="https://wa.me/254768814953" class="whatsapp-float" target="_blank">Chat with us</a>

    const map = new google.maps.Map(document.getElementById("map"), {
      zoom: 12,
      center: locations[0],
    });
    locations.forEach(loc=>{
      new google.maps.Marker({
        position: {lat: loc.lat, lng: loc.lng},
        map,
        title: loc.name
      });
    });
  }
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap"></script>

</body>
</html>
